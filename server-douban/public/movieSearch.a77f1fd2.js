webpackJsonp([2],{1177:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1180),a=o(i),s=n(526),r=o(s),l=n(65),u=o(l),c=n(3),f=o(c),d=n(6),m=o(d),v=n(4),h=o(v),g=n(5),p=o(g),L=n(0),y=o(L),_=n(86),D=o(_),k=n(1),w=o(k),E=n(525),M=o(E),T=n(1182),x=o(T);n(1184);var P=function(e){function t(e){(0,f.default)(this,t);var n=(0,h.default)(this,(t.__proto__||(0,u.default)(t)).call(this,e));return n.addEventListener=function(){n.theDiv.onscroll=function(e){if(e.target.scrollHeight===e.target.scrollTop+e.target.offsetHeight){if(n.state.isBottom)return;n.fetch(n.state.messages.keyword),n.setState({isBottom:!0})}}},n.fetch=function(e){if(n.state.messages.keyword!==e)return n.theDiv.scrollTop=0,n.theDiv.onscroll=null,void n.setState({isLoading:!0,isBottom:!1,movieListData:[],messages:{keyword:e,count:10,start:0,pageIndex:1}});console.log(7);var t=(0,r.default)({},n.state.messages),o=[].concat(n.state.movieListData);t.keyword=e,t.start=(t.pageIndex-1)*t.count,t.pageIndex++;var i=(0,a.default)(t);x.default.searchMovieListData(i).then(function(e){console.log(e),o=o.length>0?o.concat(e.subjects):e.subjects,n.setState({isLoading:!1,isBottom:!1,movieListData:o,messages:t})}).catch(function(e){console.error(e)})},n.goDetail=function(e){n.context.router.push("/movieDetail/"+e)},n.renderLoading=function(){return y.default.createElement("div",{className:"movieList_container"},y.default.createElement(M.default,null))},n.renderItem=function(e){return y.default.createElement("div",{className:"movieList_item",key:e.id+Math.random(),onClick:function(){return n.goDetail(e.id)}},y.default.createElement("img",{src:e.images.small,alt:""}),y.default.createElement("div",null,y.default.createElement("h1",null,e.title),y.default.createElement("span",null,e.year)))},n.renderMovieList=function(){return y.default.createElement("div",{ref:function(e){return n.theDiv=e},className:"movieList_container"},n.state.movieListData.map(n.renderItem),y.default.createElement("div",{className:n.state.isBottom?"movieList_show":"movieList_hide"},"正在玩命加载中, 请稍候......"))},n.shouldComponentUpdate=function(){return D.default.shouldComponentUpdate},n.state={isLoading:!0,isBottom:!1,movieListData:[],messages:{keyword:n.props.params.keyword,count:10,start:0,pageIndex:1}},n}return(0,p.default)(t,e),(0,m.default)(t,[{key:"componentDidMount",value:function(){this.fetch(this.state.messages.keyword)}},{key:"componentWillReceiveProps",value:function(e){this.fetch(e.params.keyword)}},{key:"componentDidUpdate",value:function(e,t){this.state.isLoading?this.fetch(this.state.messages.keyword):(this.theDiv.onscroll=null,this.addEventListener())}},{key:"render",value:function(){return this.state.isLoading?this.renderLoading():this.renderMovieList()}}]),t}(y.default.Component);P.propTypes={params:w.default.object},P.contextTypes={router:w.default.object},t.default=P},1180:function(e,t,n){e.exports={default:n(1181),__esModule:!0}},1181:function(e,t,n){var o=n(22),i=o.JSON||(o.JSON={stringify:JSON.stringify});e.exports=function(e){return i.stringify.apply(i,arguments)}},1182:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(523),a=o(i),s=n(524),r=o(s);t.default={getMovieListData:function(e){return console.log(e),new a.default(function(t,n){var o=""+r.default.HTTP+r.default.SERVER_PATH+":"+r.default.PORT+"/api/getMovieListData?message="+e;console.log(o),fetch(o).then(function(e){if(e.ok)return e.json();console.error("服务器忙,请稍后再试;\r\nCode:"+e.status)}).then(function(e){console.log(e),t(e)}).catch(function(e){n(e)})})},getMovieDetailData:function(e){return new a.default(function(t,n){var o=""+r.default.HTTP+r.default.SERVER_PATH+":"+r.default.PORT+"/api/getMovieDetailData?message="+e;fetch(o).then(function(e){if(e.ok)return e.json();console.error("服务器忙,请稍后再试;\r\nCode:"+e.status)}).then(function(e){t(e)}).catch(function(e){n(e)})})},searchMovieListData:function(e){return new a.default(function(t,n){var o=""+r.default.HTTP+r.default.SERVER_PATH+":"+r.default.PORT+"/api/searchMovieListData?message="+e;fetch(o).then(function(e){if(e.ok)return e.json();console.error("服务器忙,请稍后再试;\r\nCode:"+e.status)}).then(function(e){console.log(e),t(e)}).catch(function(e){n(e)})})}}},1184:function(e,t,n){var o=n(1185);"string"==typeof o&&(o=[[e.i,o,""]]);var i={};i.transform=void 0;n(1174)(o,i);o.locals&&(e.exports=o.locals)},1185:function(e,t,n){t=e.exports=n(1173)(void 0),t.push([e.i,".movieList_container{height:100%;overflow-y:scroll}.movieList_item{display:flex;height:10rem;padding-left:3rem}.movieList_item img{width:5rem;height:9rem}.movieList_item div{display:flex;flex-direction:column;justify-content:space-evenly;margin-left:3rem}.movieList_item h1{font-size:1rem}.movieList_hide{display:none}.movieList_show{background-color:#6ccbeb;text-align:center}",""])}});